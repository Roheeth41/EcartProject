<!DOCTYPE html>
{% load static %}

{% url 'remove' as remove %}

{% url 'buy' as buy %}

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Shoppee</title>
    <link rel="stylesheet" type="text/css" href="{% static "CSS/myStyle.css" %}" />
</head>

<body>
    {% if user.is_authenticated %}
    <div style="background-color:teal; border-radius: 20px;">
        {% include '../base.html' %}
        <div>
            <div class="container">
                <div class="row">
                    <br>
                    <form action="search">
                        <div class="column_search">
                            <input id="search" name="search" type="text" class="query-search" placeholder="Search...">
                            <button type="submit">Search</button>
                        </div>
                    </form>
                    <div class="column_logout">
                        <form action="logout" method="POST" style="float: right;">
                            {% csrf_token %}
                                <a>
                                    <button class="search_button" type="submit" class="logout">LOG OUT</button>
                                </a>
                        </form>
                    </div>
                    <div class="column_logout" style="text-align:left ;">
                        <a href="{% url 'cart' %}"></a>
                            <button type="submit">Cart:<span>{{ product.count }}</span></button>                  
                    </div>
                    <div class="column_logout" style="text-align:left ;">
                            <a href="{% url 'order' %}">
                                <button type="submit">Orders</button>
                            </a>                      
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="container">
            {% if product.count != 0 %}
            {% for item in product %}
            <div class="row">
                <div class='column_cart_1'>
                    <img width=100 height=100 src="{{ item.image.url }}" alt="Product One" style="float: left;">
                    <h1>{{ item.name }}</h1>
                    <h2 style="text-align: center;">Rs.{{ item.price }}</h2>
                </div>
                <div class='column_cart_2'>
                    <br>
                    <br>
                    <form action="{{ buy }}{{ item.id }}" method="POST">
                        {% csrf_token %}
                        <input id="quantity" type="number" style="text-align:center" max="99" min="1" name="quantity" value="1">
                        <button type="submit">Buy Now</button>
                    </form>
                    <br>
                    <form action="{{ remove }}{{ item.id }}" method="POST">
                        {% csrf_token %}
                            <button type="submit">Remove Item</button>
                    </form>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <h2 style="text-align: center;"> No Items in the Cart</h2>
            {% endif %}
        </div>
    </div>
    {% else %}
    <h2 style="text-align: center; color:blue">Redirecting to Login...</h2>
    <meta http-equiv="refresh" content="1; URL=/" />
    {% endif %}
</body>
</html>